// --------- DECLARAÇÃO DE CONSTANCIAS BARRAS ---------//

const INTERNAL = setInterval(() => {
    const BARRA_MENU = document.querySelector("#barraMenu");
    const BARRA_SUP = document.querySelector("#barraSistemaSup");

    //--------------- BARRA SUPERIOR----------------------//

    if (BARRA_MENU) {
        clearInterval(INTERNAL);
        BARRA_SUP.innerHTML = "CANCELAMENTO/DEVOLUÇÃO - AUTOMÁTICO DE SOLICITAÇÕES";
        BARRA_SUP.style.color = "#F5F5F5";
        BARRA_SUP.style.background = "#64DD17"
        BARRA_SUP.style.fontSize = "1.6rem";

        BARRA_SUP.style.border = "none";

        // --------- DECLARAÇÃO DE MENU ----------------------//        

        const MENU_CANCEL_DEVOLVIDO = document.createElement("a");
        MENU_CANCEL_DEVOLVIDO.innerHTML = " CANCELAR DEVOLUÇÃO   ";
        MENU_CANCEL_DEVOLVIDO.style.color = "#F5F5F5";
        MENU_CANCEL_DEVOLVIDO.style.height = "auto";
        MENU_CANCEL_DEVOLVIDO.classList.add("cancelandoDevolvidosNx");

        const BARRA_PROGRESSO = document.createElement("progress");
        BARRA_PROGRESSO.classList.add("barraProgressoNx");

        BARRA_MENU.appendChild(MENU_CANCEL_DEVOLVIDO);
        BARRA_MENU.appendChild(BARRA_PROGRESSO);

        // --------- DECLARAÇÃO DO CANCELAMENTO --------------// 

        MENU_CANCEL_DEVOLVIDO.addEventListener("click", () => {
            let qtdeCancelamentos = prompt("Tenho " + listaCodSol.length + " solicitações para cancelar. Quantas devo cancelar? Informe a quantidade.");
            if (qtdeCancelamentos > listaCodSol.length || qtdeCancelamentos <= 0) {
                alert("Quantidade digitada não pode ser maior que o total apresentado a você. E nem zero ou menor que zero.");
            }
            else {
                let numFinal = qtdeCancelamentos;
                if (window.confirm(`Tem certeza que devo cancelar ${numFinal} solicitações`)) {
                    let index = 0;
                    BARRA_PROGRESSO.max = numFinal;
                    const TEMPO_RESTANTE = setInterval(() => {

                        // -- DECLARAÇÃO MENSAGEM COLOCADA NO CANCELAMENTO ---// 

                        let justifica = "A Central de Regulação Ambulatorial efetuou o cancelamento administrativo desta solicitação por falta de reenvio/reavaliação/resposta/informações registradas pelo profissional Regulador de sua central ao longo do tempo. Recomendamos que, caso o paciente ainda necessite de agendamento para o atendimento, procure a Unidade de Saúde em busca de atendimento, uma nova solicitação deverá ser inserida seguindo a orientação do Regulador e protocolo de acesso vigente."

                        let url = "https://sisregiii.saude.gov.br/cgi-bin/gerenciador_solicitacao?etapa=CANCELAR_SOLICITACAO&co_seq_solicitacao=" + listaCodSol[index] + "&st_situacao=C&ds_observacao=" + justifica;

                        // -- DECLARAÇÃO DA QUANT DE SOLICITACAO CANCELADA ---// 

                        let siteSisreg = new XMLHttpRequest();
                        siteSisreg.open("GET", url, false);
                        siteSisreg.send();

                        index = index + 1;
                        BARRA_PROGRESSO.value = index;
                        BARRA_SUP.style.color = "#F5F5F5";
                        BARRA_SUP.style.fontSize = "1.6rem";
                        BARRA_SUP.innerHTML = "Ultimo código cancelado: " + (listaCodSol[index - 1]) + " /  " + index + " de  " + numFinal;

                        // ---------- MENSAGEM DE FINALIZAÇÃO ----------------//

                        if (index == numFinal) {
                            BARRA_SUP.innerHTML = "Ultimo código cancelado: " + (listaCodSol[index - 1]) + " /  " + index + " de  " + numFinal + " TERMINADO!!!";
                            clearInterval(TEMPO_RESTANTE);
                        }
                    }, 2000);
                } else {
                    alert("Comando Cancelado.");
                }
            }
        }
        )
    }
}, 2000);



// --------- LISTA DE SOLICITAÇÃO PARA CANCELAR ------//

var listaCodSol = [
    "282330921",
    "263873026",
    "283433292",
    "283775368",
    "280788481",
    "283607512",
    "283795500",
    "278878481",
    "283785908",
    "267627490",
    "269053723",
    "271717595",
    "272054708",
    "274809584",
    "278651227",
    "266279528",
    "283741129",
    "283401944",
    "270338874",
    "271441388",
    "280187171",
    "280839121",
    "274628971",
    "278867472",
    "278889116",
    "278101427",
    "277546415",
    "282676149",
    "282960157",
    "283748161",
    "283716989",
    "272099057",
    "253505863",
    "265940537",
    "265953329",
    "283004877",
    "283294813",
    "283678363",
    "231815666",
    "282924799",
    "283080464",
    "283815478",
    "283616148",
    "280568453",
    "256807520",
    "278074671",
    "278476107",
    "283028207",
    "283321713",
    "283028747",
    "283382703",
    "283857412",
    "263460542",
    "283402071",
    "283879066",
    "275758163",
    "275880702",
    "276105292",
    "276647670",
    "276652400",
    "277050699",
    "277460711",
    "278086691",
    "278976066",
    "275958200",
    "286442762",
    "286581004",
    "283818811",
    "245956607",
    "249529644",
    "285314328",
    "284761768",
    "273890239",
    "238927584",
    "279063318",
    "283359222",
    "284760238",
    "282948511",
    "286076624",
    "286880773",
    "286529898",
    "286577287",
    "282384734",
    "232581900",
    "236220408",
    "286659440",
    "286964642",
    "287611340",
    "231081645",
    "236837868",
    "238129200",
    "253363002",
    "253418319",
    "253498316",
    "238475050",
    "274913966",
    "286507523",
    "286500833",
    "286477543",
    "283763491",
    "286943160",
    "252995423",
    "279052298",
    "279351752",
    "251881215",
    "288056427",
    "256618056",
    "288202881",
    "288203980",
    "260097748",
    "270699013",
    "271081030",
    "271150140",
    "271531246",
    "288241204",
    "287642915",
    "288160687",
    "288261217",
    "272735697",
    "283839752",
    "282139713",
    "272900635",
    "284256343",
    "228494125",
    "228681198",
    "228804870",
    "284563037",
    "260151881",
    "284580932",
    "241245154",
    "229345134",
    "241507153",
    "282139175",
    "243584203",
    "282144466",
    "243589355",
    "243647978",
    "243686060",
    "229345853",
    "244469021",
    "229346275",
    "229347543",
    "282390845",
    "244927486",
    "282477880",
    "245015993",
    "247125619",
    "247292169",
    "289275503",
    "247320253",
    "247342516",
    "287188320",
    "288364486",
    "288361260",
    "288362539",
    "288360537",
    "288569384",
    "280569670",
    "283681261",
    "274190824",
    "274213900",
    "274216757",
    "274238281",
    "274253740",
    "274293095",
    "274294448",
    "274297441",
    "274299689",
    "274302070",
    "274310912",
    "274376753",
    "274502752",
    "274520058",
    "275196149",
    "275539697",
    "275797645",
    "275872661",
    "275879659",
    "275883424",
    "286977356",
    "287334294",
    "287347123",
    "287034453",
    "277132527",
    "261367748",
    "269646193",
    "258806324",
    "276911897",
    "277332158",
    "278262540",
    "275088097",
    "275807463",
    "277259347",
    "249835886",
    "262942202",
    "287795803",
    "237427050",
    "243576512",
    "247555087",
    "247567435",
    "247597796",
    "247854635",
    "247899152",
    "250125325",
    "251275195",
    "251309802",
    "288518283",
    "251625964",
    "251441787",
    "250530162",
    "254401048",
    "252940411",
    "255512983",
    "255517356",
    "255666251",
    "256793552",
    "259002315",
    "259127103",
    "259710961",
    "259772739",
    "260590905",
    "260681740",
    "263389871",
    "263412783",
    "263442832",
    "263808516",
    "264167046",
    "264379803",
    "264457279",
    "264839147",
    "283670699",
    "282511992",
    "277339594",
    "282802262",
    "264985860",
    "239752097",
    "239767883",
    "239940576",
    "240001324",
    "240087754",
    "240154503",
    "240167889",
    "240169039",
    "240193233",
    "240193636",
    "240193817",
    "282070768",
    "282074592",
    "282075579",
    "282078487",
    "282079329",
    "282097668",
    "282098960",
    "282100977",
    "282103982",
    "282118261",
    "282120388",
    "282123395",
    "282127145",
    "282132165",
    "282165719",
    "282980409",
    "282982893",
    "282983307",
    "282983655",
    "282984120",
    "282984640",
    "282986283",
    "282988079",
    "283195696",
    "283196559",
    "283197384",
    "286882825",
    "286883715",
    "286900003",
    "286901419",
    "286910788",
    "286918318",
    "286919518",
    "286928314",
    "286929358",
    "286930992",
    "286933080",
    "286933709",
    "286939108",
    "286940057",
    "286942457",
    "286944532",
    "286945008",
    "286946308",
    "286949383",
    "286951033",
    "286952297",
    "286953238",
    "291892901",
    "291991836",
    "287177976",
    "291495334",
    "288874116",
    "291783071",
    "291269973",
    "291277374",
    "290885981",
    "291278373",
    "291281305",
    "291283194",
    "291286468",
    "291832631",
    "257427995",
    "291032111",
    "291046615",
    "284683966",
    "291305955",
    "291306723",
    "291307503",
    "291311124",
    "291312470",
    "291345260",
    "291430679",
    "291313646",
    "291314550",
    "291316192",
    "291317055",
    "291317879",
    "291318958",
    "291320030",
    "291320801",
    "291595469",
    "291321693",
    "291324813",
    "291325597",
    "291735698",
    "287182586",
    "292096108",
    "288300571",
    "287596150",
    "291927337",
    "288585388",
    "292035079",
    "290927639",
    "291292869",
    "291565874",
    "291664361",
    "289717983",
    "289741896",
    "289809346",
    "290852150",
    "291247399",
    "291722605",
    "278423210",
    "291919656",
    "291812187",
    "278688570",
    "291528145",
    "278873561",
    "292960753",
    "265056734",
    "288832879",
    "293293855",
    "288898974",
    "289459605",
    "291110937",
    "289563433",
    "293337686",
    "293392048",
    "293406093",
    "293387547",
    "291603337",
    "293473090",
    "293607960",
    "293432611",
    "290495782",
    "293617388",
    "290642215",
    "293033738",
    "293675847",
    "291114474",
    "293115035",
    "293746021",
    "293748120",
    "293554507",
    "288580568",
    "288724207",
    "288600420",
    "292304116",
    "292614475",
    "292205071",
    "292982996",
    "293743454",
    "292293771",
    "293302712",
    "293163637",
    "293544271",
    "293161612",
    "274730176",
    "278660247",
    "293592884",
    "292593703",
    "291021645",
    "292429343",
    "289324753",
    "232737531",
    "261681432",
    "267384690",
    "255903647",
    "257831362",
    "266325943",
    "263018138",
    "264092468",
    "265055247",
    "261229367",
    "271958444",
    "246748295",
    "293787878",
    "293789828",
    "292013274",
    "282397852",
    "287909291",
    "293711279",
    "293852063",
    "292079402",
    "292925180",
    "293800080",
    "293450059",
    "293804100",
    "293802771",
    "293779507",
    "293865590",
    "280493442",
    "293809146",
    "293813196",
    "257327814",
    "293592820",
    "293599112",
    "293817986",
    "281402652",
    "281870438",
    "282742280",
    "284981363",
    "283539763",
    "293856198",
    "283761521",
    "283940132",
    "293739582",
    "293742623",
    "293687949",
    "292036470",
    "293927311",
    "278123464",
    "264981138",
    "266779947",
    "289793278",
    "291293740",


]